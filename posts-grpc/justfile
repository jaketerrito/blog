build: down-server
    docker compose build development

up: up-db build up-server up-grpcui

up-db:
    docker compose up -d db


up-grpcui:
    docker compose up -d grpcui

up-server:
    docker compose up -d development

down: down-server down-db down-grpcui

down-server:
    docker compose down development -v

down-db:
    docker compose down db

down-grpcui:
    docker compose down grpcui

logs:
    docker compose logs -f

logs-severr:
    docker compose logs -f development

check:
    docker compose run --rm development ruff check .
    docker compose run --rm development ruff format . --check

fix:
    docker compose run --rm development ruff check --fix
    docker compose run --rm development ruff format .

test:
    docker compose run --rm development pytest --cov=src --cov-report=xml:coverage.xml

proto:
    docker compose run --rm -v $(pwd)/../proto:/proto development python -m grpc_tools.protoc -Isrc/proto=/proto/posts/v1 --python_out=/app --pyi_out=/app --grpc_python_out=/app /proto/posts/v1/posts.proto